import{c as n,d,t as B,n as L,a as S,u as N,r as C,b as x,o as A,q as D,e,l as k,F as y,h as w,m as h,i as F,j as T,k as q,L as U,p as V}from"./index-60ce0b05.js";import{i as $,_ as j}from"./Template-0f6e6b4d.js";const O="/assets/info-a790967c.svg",E={__name:"BranchButton",props:{branch:Object,active:Boolean},emits:["change"],setup(f,{emit:g}){const r=g;return(i,l)=>(n(),d("span",{onClick:l[0]||(l[0]=()=>r("change",f.branch.id)),class:L(["w-fit px-2.5 py-1 rounded-full text-white cursor-pointer",f.active?"bg-text_color":"bg-hint_color"])},B(f.branch.attributes.title),3))}},z=e("input",{type:"checkbox",id:"my_modal_7",className:"modal-toggle"},null,-1),W=e("div",{className:"modal",role:"dialog"},[e("div",{className:"modal-box"},[e("h3",{className:"text-lg font-bold"},"Пример заполнения"),e("p",{className:"pt-4"},"Директор мебельной фабрики «Ромашка». Мы производим качественную мебель для дома и офиса уже 20 лет. Наша компания — надёжный партнёр, который всегда соблюдает сроки и учитывает пожелания клиентов. Готов поделиться опытом"),e("div",{className:"modal-action"},[e("label",{htmlFor:"my_modal_7",className:"bg-hint_color px-4 py-2.5 rounded-xl cursor-pointer"},"Закрыть")])]),e("label",{className:"modal-backdrop",htmlFor:"my_modal_7"},"Close")],-1),I=e("div",{class:"flex justify-center mb-2"},[e("label",{htmlFor:"my_modal_7",class:"flex gap-x-2 cursor-pointer items-center font-sera_bold p-2.5 rounded-full rounded-tr-none text-text_color bg-hint_color"},[e("span",{class:"flex w-5 h-5"},[e("img",{src:O,alt:"Info icon",class:"w-full h-full object-contain"})]),e("span",null,"Пример заполнения")])],-1),M={class:"flex relative"},R={class:"absolute text-sm text-text_color right-4 bottom-3"},H={key:0,className:"form-control gap-y-2"},X=e("span",{class:"font-sera_bold text-lg"},"Я предлагаю:",-1),G={class:"flex gap-2 flex-wrap"},J={key:1,className:"form-control gap-y-2"},K=e("span",{class:"font-sera_bold text-lg"},"Я ищу:",-1),P={class:"flex gap-2 flex-wrap"},Q=e("span",null,null,-1),Y=["disabled"],Z=e("p",null,"После отправки вашей анкеты мы сможем подобрать для вас соискателей",-1),ee={__name:"About",emits:["submit"],setup(f,{emit:g}){S(()=>{i();const s=document.querySelectorAll("input"),a=document.querySelectorAll("textarea");s&&s.forEach(u=>{u.removeEventListener("focus",r),u.removeEventListener("blur",i)}),a&&a.forEach(u=>{u.removeEventListener("focus",r),u.removeEventListener("blur",i)})});const r=()=>{if($()){const s=document.querySelector("body");s&&s.classList.add("pb-80")}},i=()=>{const s=document.querySelector("body");s&&s.classList.remove("pb-80")},l=N(),_=g,t=C({about:"",lookingFors:[],suggests:[]}),p=window.Telegram.WebApp,v=()=>{if(!t.about||t.about.length<16)return p.showAlert("Описание профиля не заполнено");if(!t.lookingFors)return p.showAlert('Выберите как минимум один пункт из секции "Я ищу"');if(!t.suggests)return p.showAlert('Выберите как минимум один пункт из секции "Я предлагаю"');_("submit",t)},c=x(null);A(()=>{const s=document.querySelectorAll("input"),a=document.querySelectorAll("textarea");s&&s.forEach(o=>{o.addEventListener("focus",r),o.addEventListener("blur",i)}),a&&a.forEach(o=>{o.addEventListener("focus",r),o.addEventListener("blur",i)}),(async()=>{c.value=await l.getBranches()})()});const m=s=>{const a=t.suggests.indexOf(s);a===-1?t.suggests.push(s):t.suggests.splice(a,1)},b=s=>{const a=t.lookingFors.indexOf(s);a===-1?t.lookingFors.push(s):t.lookingFors.splice(a,1)};return(s,a)=>{const u=D("resize-textarea");return n(),d("form",{onSubmit:a[1]||(a[1]=o=>{o.preventDefault()}),class:"flex flex-col gap-y-2"},[z,W,I,e("div",M,[k(u,{class:"outline-none bg-secondary_bg_color !p-4 rounded-xl placeholder:text-text_color w-full",placeholder:"Краткое описание",minHeight:140,maxLength:"200",minLength:"16",modelValue:t.about,"onUpdate:modelValue":a[0]||(a[0]=o=>t.about=o)},null,8,["modelValue"]),e("span",R,B(200-t.about.length),1)]),c.value&&c.value.data.length>0?(n(),d("div",H,[X,e("div",G,[(n(!0),d(y,null,w(c.value.data,o=>(n(),h(E,{key:o.id,active:t.suggests.includes(o.id),branch:o,onChange:m},null,8,["active","branch"]))),128))])])):F("",!0),c.value&&c.value.data.length>0?(n(),d("div",J,[K,e("div",P,[(n(!0),d(y,null,w(c.value.data,o=>(n(),h(E,{key:o.id,active:t.lookingFors.includes(o.id),branch:o,onChange:b},null,8,["active","branch"]))),128))])])):F("",!0),Q,e("button",{onClick:v,disabled:t.lookingFors.length<1||t.suggests.length<1,class:L(["transition-all p-3 rounded-full uppercase text-lg",(t.lookingFors.length<1||t.suggests.length<1)&&"bg-secondary_bg_color text-text-color"])},"Отправить",10,Y),Z],32)}}},te={key:0,class:"flex flex-col p-4 gap-y-4"},se={key:0,class:"flex flex-col gap-y-4"},oe=e("h1",{class:"font-sera_bold text-xl"},"Заполните информацию о себе",-1),le={__name:"Index",setup(f){var c;const g=x(!0),r=N(),i=((c=window.Telegram.WebApp.initDataUnsafe.user)==null?void 0:c.id)||T.BOT.TEST_USER,l=x(null),_=window.Telegram.WebApp,t=q(),p=()=>{t.push({name:"INDEX"})};A(()=>{_.BackButton.show(),_.onEvent("backButtonClicked",p),(async()=>{l.value=await r.getUserData(i),g.value=!1})()}),S(()=>{_.BackButton.hide(),_.offEvent("backButtonClicked",p)});const v=async m=>{const b=await r.setUserData(l.value.id,{about:m.about,lookingFors:m.lookingFors,suggests:m.suggests,active:!0,publishedAt:null,status:"wait"});b&&(l.value=b.data)};return(m,b)=>{var s;return g.value?(n(),h(V,{key:1})):(n(),d("div",te,[k(U),!((s=l.value.attributes)!=null&&s.active)||l.value.attributes.status==="rejected"?(n(),d("div",se,[oe,k(ee,{onSubmit:v})])):(n(),h(j,{key:1,title:"Поздравляем, вы зарегистрированы!",subTitle:"Теперь с вами могут связаться заинтересованные люди",answer:"Хотите посмотреть контакты из вашей отрасли?",buttonText:"Посмотреть контакты",to:"/networking"}))]))}}};export{le as default};
